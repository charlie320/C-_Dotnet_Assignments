<linK rel="stylesheet" href="~/css/dashboard.css">

@model WeddingPlanner.Models.Wedding
@using WeddingPlanner.Models;

<h1>Welcome @ViewBag.currentUser.FirstName</h1>
<h2>Upcoming Weddings</h2>
<table>
    <tr>
        <th>
            Wedding
        </th>
        <th>
            Date
        </th>
        <th>
            Guests
        </th>
        <th>
            Action
        </th>
    </tr>

    @{
        foreach (Wedding wedding in @ViewBag.allWeddings) {
                <tr>
                    <td>
                        <a href="/wedding/@wedding.WeddingId">@wedding.WedderOne &amp; @wedding.WedderTwo</a>
                    </td>
                    <td>
                        @wedding.Date.ToString("MMM d, yyyy")
                    </td>
                    <td>
                        @wedding.GuestsAttending.Count
                    </td>
                    <td>
                        @if (@ViewBag.currentUser.UserId == wedding.PlannerId) {
                            <a href="delete/@wedding.WeddingId">Delete</a>
                        } else if (wedding.GuestsAttending.Where(g => g.GuestId == @ViewBag.currentUser.UserId).SingleOrDefault() == null) {
                            <form action="CreateConfirmation" method="POST">
                                <input type="hidden" name="weddingId" value=@wedding.WeddingId>
                                <input type="submit" value="RSVP">
                            </form>
                        } else {
                            <a href="cancel/@wedding.WeddingId">Cancel</a>
                        }
                    </td>
                </tr>
        }
    }

</table>

<a href="newwedding">New Wedding</a>